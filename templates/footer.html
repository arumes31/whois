{{ define "footer" }}
</div> <!-- End container-fluid -->
</main> <!-- End Main Content -->
</div> <!-- End App Container -->

<!-- Tool Modals -->
<div class="modal fade" id="toolModal" tabindex="-1">
    <div class="modal-dialog modal-xl modal-dialog-centered">
        <div class="modal-content glass-panel border-nordic shadow-lg">
            <div class="modal-header border-0 pb-0">
                <h5 class="modal-title fw-bold" id="toolTitle"><svg style="width:16px;height:16px;margin-right:8px;fill:#ffc107" viewBox="0 0 512 512"><path d="M416 208c0 45.9-14.9 88.3-40 122.7L502.6 457.4c12.5 12.5 12.5 32.8 0 45.3s-32.8 12.5-45.3 0L330.7 376c-34.4 25.2-76.8 40-122.7 40C93.1 416 0 322.9 0 208S93.1 0 208 0S416 93.1 416 208zM208 352a144 144 0 1 0 0-288 144 144 0 1 0 0 288z"/></svg>Tool</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" title="Close modal"></button>
            </div>
            <div class="modal-body pt-3" id="toolBody">
                <!-- Content injected via JS -->
            </div>
        </div>
    </div>
</div>

<!-- Security Disclosure Modal -->
<div class="modal fade" id="disclosureModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
    <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content glass-panel border-nordic shadow-lg">
            <div class="modal-header border-0">
                <h4 class="modal-title fw-bold text-danger"><svg style="width:24px;height:24px;margin-right:12px;fill:currentColor" viewBox="0 0 512 512"><path d="M256 0c4.6 0 9.2 1 13.4 2.9L457.7 82.8c22 9.3 38.4 31 38.3 57.2c-.5 99.2-41.3 280.7-213.6 363.2c-16.7 8-36.1 8-52.8 0C57.3 420.7 16.5 239.2 16 140c-.1-26.2 16.3-47.9 38.3-57.2L242.7 2.9C246.8 1 251.4 0 256 0zm0 66.8V444.8C394 378 431.1 230.1 432 141.4L256 66.8z"/></svg> SECURITY & LEGAL DISCLOSURE</h4>
            </div>
            <div class="modal-body">
                <div class="p-3 bg-dark-dim border-start border-danger border-4 mb-4">
                    <h6 class="fw-bold text-white mb-2">AUTHORIZED USE ONLY</h6>
                    <p class="small text-white opacity-75 mb-0">This platform is designed for professional network diagnostics and reconnaissance. By proceeding, you acknowledge that you are authorized to scan the targets you enter and that your actions comply with local laws and regulations.</p>
                </div>
                
                <div class="row g-4">
                    <div class="col-md-6 border-end border-secondary border-opacity-10">
                        <h6 class="fw-bold text-info"><svg style="width:14px;height:14px;margin-right:8px;fill:currentColor" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zM216 336h24V272H216c-13.3 0-24-10.7-24-24s10.7-24 24-24h48c13.3 0 24 10.7 24 24v88h8c13.3 0 24 10.7 24 24s-10.7 24-24 24H216c-13.3 0-24-10.7-24-24s10.7-24 24-24zm40-208a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"/></svg> DATA & COOKIES</h6>
                        <p class="small text-white opacity-75">We use local storage and functional cookies to remember your UI configuration and scan settings. No tracking or marketing data is collected.</p>
                    </div>
                    <div class="col-md-6">
                        <h6 class="fw-bold text-warning"><svg style="width:14px;height:14px;margin-right:8px;fill:currentColor" viewBox="0 0 512 512"><path d="M256 512A256 256 0 1 0 256 0a256 256 0 1 0 0 512zm0-384c13.3 0 24 10.7 24 24V264c0 13.3-10.7 24-24 24s-24-10.7-24-24V152c0-13.3 10.7-24 24-24zm32 224a32 32 0 1 1 -64 0 32 32 0 1 1 64 0z"/></svg> TERMS OF SERVICE</h6>
                        <p class="small text-white opacity-75">Service is provided "as-is" without warranty. Users assume all liability for scan traffic and resource consumption on target networks.</p>
                    </div>
                </div>
            </div>
            <div class="modal-footer border-0 pt-0">
                <button type="button" class="btn btn-danger px-5 fw-bold" onclick="acceptDisclosure()">I ACCEPT & AGREE</button>
            </div>
        </div>
    </div>
</div>

<script src="/static/vendor/bootstrap.bundle.min.js"></script>
<script src="/static/vendor/prism.min.js"></script>

<script>
    function acceptDisclosure() {
        localStorage.setItem('whois_disclosure_accepted', 'true');
        const modalEl = document.getElementById('disclosureModal');
        const modal = bootstrap.Modal.getInstance(modalEl);
        modal.hide();
    }

    function checkDisclosure() {
        if (!localStorage.getItem('whois_disclosure_accepted')) {
            const modalEl = document.getElementById('disclosureModal');
            const modal = new bootstrap.Modal(modalEl);
            modal.show();
        }
    }

    document.addEventListener('DOMContentLoaded', checkDisclosure);

    function openTool(type) {
        const modalEl = document.getElementById('toolModal');
        const modal = new bootstrap.Modal(modalEl);
        const title = document.getElementById('toolTitle');
        const body = document.getElementById('toolBody');
        
        if (type === 'dns') {
            title.innerText = 'Single DNS Lookup';
            body.innerHTML = `
                <form hx-post="/dns_lookup" hx-target="#toolRes" hx-indicator="#toolSpin">
                    <input type="text" class="form-control matrix-input mb-3" name="domain" placeholder="example.com" required>
                    <select class="form-select matrix-input mb-3" name="type">
                        <option value="A">A</option><option value="AAAA">AAAA</option><option value="MX">MX</option>
                        <option value="TXT">TXT</option><option value="NS">NS</option><option value="PTR">PTR</option>
                    </select>
                    <button class="btn btn-danger w-100">RUN LOOKUP</button>
                    <div id="toolSpin" class="htmx-indicator text-center mt-3"><div class="spinner-border text-danger"></div></div>
                    <div id="toolRes" class="mt-3"></div>
                </form>`;
        } else if (type === 'mac') {
            title.innerText = 'MAC Address Lookup';
            body.innerHTML = `
                <form hx-post="/mac_lookup" hx-target="#toolRes" hx-indicator="#toolSpin">
                    <input type="text" class="form-control matrix-input mb-3" name="mac" placeholder="00:11:22:33:44:55" required>
                    <button class="btn btn-danger w-100"><svg style="width:14px;height:14px;margin-right:8px;fill:currentColor" viewBox="0 0 512 512"><path d="M0 80V432c0 26.5 21.5 48 48 48H464c26.5 0 48-21.5 48-48V80c0-26.5-21.5-48-48-48H48C21.5 32 0 53.5 0 80zM64 96H96v320H64V96zm64 0h32v320H128V96zM224 96h64V416H224V96zm96 0h32v320H320V96zm64 0h32v320H384V96zm64 0h32v320H448V96z"/></svg>IDENTIFY VENDOR</button>
                    <div id="toolSpin" class="htmx-indicator text-center mt-3"><div class="spinner-border text-danger"></div></div>
                    <div id="toolRes" class="mt-3"></div>
                </form>`;
        }
        
        htmx.process(body);
        modal.show();
    }

    // Initialize connection and settings
    if (typeof loadSettings === 'function') loadSettings();
    if (typeof connectWS === 'function') connectWS();

    // Global tooltips - Consolidated to prevent double-init
    tippy('[title], [data-tippy-content]', {
        theme: 'matrix',
        content(reference) {
            const content = reference.getAttribute('data-tippy-content') || reference.getAttribute('title');
            if (reference.hasAttribute('title')) {
                reference.setAttribute('data-tippy-original-title', reference.getAttribute('title'));
                reference.removeAttribute('title');
            }
            return content;
        },
        placement(reference) {
            return reference.classList.contains('help-icon') ? 'right' : 'top';
        },
        allowHTML: true
    });
</script>

</body>
</html>
{{ end }}