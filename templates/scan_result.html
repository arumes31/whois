{{ if .result.Error }}
  <div class="alert alert-danger">
    <strong>Errors:</strong>
    <ul>
    {{ range .result.Error }}
      <li>{{ . }}</li>
    {{ end }}
    </ul>
  </div>
{{ else }}
  <div class="alert alert-info mb-2">
    <strong>Target:</strong> {{ .target }} – scanned in {{ printf "%.3f" .result.Elapsed }} s
  </div>

  {{ if .result.Open }}
    <div class="alert alert-success">
      <strong class="text-dark">Open ({{ len .result.Open }})</strong>:
      <div class="list-group list-group-flush mt-2">
        {{ range $port, $banner := .result.Open }}
          <div class="list-group-item bg-light text-dark border-secondary p-1">
            <small><strong>Port {{ $port }}</strong></small>
            {{ if $banner }}
              <pre class="mb-0 text-primary" style="font-size: 0.7rem; overflow: hidden; text-overflow: ellipsis;"><code>{{ $banner }}</code></pre>
            {{ end }}
          </div>
        {{ end }}
      </div>
    </div>
  {{ else }}
    <div class="alert alert-secondary">No open ports detected.</div>
  {{ end }}

  {{ if .result.Closed }}
    <details class="mt-2">
      <summary class="text-muted">Closed ports ({{ len .result.Closed }}) – click to view</summary>
      <code class="d-block mt-1 text-muted">
        {{ range $i, $p := .result.Closed }}{{ if $i }}, {{ end }}{{ $p }}{{ end }}
      </code>
    </details>
  {{ end }}
{{ end }}
