{{ template "header" . }}

<div class="container mt-4">
  <h2 class="mb-4 fw-bold"><i class="fas fa-desktop me-2"></i> MONITORING CONFIGURATION</h2>
  <p class="text-muted small italic">Automated logs are compiled <strong>every 24 hours</strong>.</p>

  <div class="row g-4">
    <div class="col-md-5">
      <div class="glass-panel p-4 mb-4">
        <div class="mb-4">
          <h5 class="mb-0 fw-bold text-success"><i class="fas fa-plus me-2"></i> ADD NEW ITEM</h5>
          <hr class="border-secondary opacity-25">
        </div>
        <div>
          <form method="post">
            <div class="mb-3">
              <input 
                type="text" 
                class="form-control matrix-input" 
                name="item" 
                placeholder="example.com or 8.8.8.8" 
                required>
              <small class="text-muted font-monospace">Domain or IP address</small>
            </div>
            <button type="submit" name="action" value="add" class="btn btn-danger w-100">ADD TO MONITORING</button>
          </form>
        </div>
      </div>

      <div class="glass-panel p-4">
        <div class="mb-4">
          <h5 class="mb-0 fw-bold text-warning"><i class="fas fa-globe-americas me-2"></i> GEOIP DATABASE</h5>
          <hr class="border-secondary opacity-25">
        </div>
        <div>
            <button 
                hx-post="/config/update-geo" 
                hx-target="#geoUpdateRes" 
                hx-indicator="#geoSpin"
                class="btn btn-outline-warning w-100 fw-bold">
                FORCE DATABASE UPDATE
            </button>
            <div id="geoSpin" class="htmx-indicator text-center mt-3">
                <div class="spinner-border spinner-border-sm text-warning"></div>
                <span class="small text-muted ms-2">Updating database...</span>
            </div>
            <div id="geoUpdateRes" class="mt-3 small font-monospace"></div>
        </div>
      </div>
    </div>

    <div class="col-md-7">
      <div class="glass-panel p-4">
        <div class="mb-4">
          <h5 class="mb-0 fw-bold text-info"><i class="fas fa-list me-2"></i> CURRENTLY MONITORED ({{ len .monitored }})</h5>
          <hr class="border-secondary opacity-25">
        </div>
        <div>
          {{ if .monitored }}
            <ul class="list-group list-group-flush bg-transparent">
              {{ range .monitored }}
                <li class="list-group-item bg-transparent d-flex justify-content-between align-items-center border-secondary opacity-75">
                  <code class="text-info">{{ . }}</code>
                  <form method="post" class="d-inline">
                    <input type="hidden" name="item" value="{{ . }}">
                    <button type="submit" name="action" value="remove" class="btn btn-sm btn-outline-danger px-3">REMOVE</button>
                  </form>
                </li>
              {{ end }}
            </ul>
          {{ else }}
            <p class="text-muted mb-0 italic">No items are being monitored.</p>
          {{ end }}
        </div>
      </div>
    </div>
  </div>
</div>

{{ template "footer" . }}
